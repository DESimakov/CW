# CW 
# ИСПРАВИТЬ ОШИБКУ В МОДЕЛЯХ С ПРИРАЩЕНИЯМИ: ПРОВЕРИТЬ ДИСКРЕТНЫЕ ВАРИАНТЫ r_t == r_{t-1}
Здесь будут выкладываться файлы с продвижением в написании курсовой работы.
## Данные
1) [Сырые данные для разных ставок](https://github.com/DESimakov/CW/blob/master/mosprime.csv) 
2) [Данные для MOSPRIME 3m полные с 01-09-2007 по 22-12-2017](https://github.com/DESimakov/CW/blob/master/mosprime3m.csv)
3) [Данные для MOSPRIME 3m средние с 01-04-2010 по 01-04-2013](https://github.com/DESimakov/CW/blob/master/mosprime3m_between.csv)
4) [Данные для MOSPRIME 3m короткие с 02-04-2012 по 31-08-2012](https://github.com/DESimakov/CW/blob/master/mosprime3m_short.csv)
## Визуализация данных
Графики данных. Сравнение разных временных отрезков, их гистограммы. Месячное скользящее среднее для ставки, ее волатильности. [Ноутбук](https://github.com/DESimakov/CW/blob/master/CW_data_and_visualisation.ipynb) 
## Калибровка ошибки MAPE
Для моделей Мертона и однофакторной Халла-Вайта найдены оптимальные параметры путем минимизации ошибки MAPE. [Ноутбук](https://github.com/DESimakov/CW/blob/master/CWm-calibration_MAPE.ipynb)
## Калибровка при помощи максимизации правдоподобия
Для моделей Мертона и однофакторной Халла-Вайта найдены оптимальные параметры путем максимизации функции правдоподобия. Определение влияния начального приближения. Добавлена стандартная реализация для HW1. **исправить путь HW1** [Ноутбук](https://github.com/DESimakov/CW/blob/master/CWm-calibration_ML.ipynb)
### Сравнение разных предпосылок о распределении для Мертона + скользящее окно
Нормальная реализация МП для приращений. Оценка параметров методом наименьших квадратов. Скользящее окно. **Графики параметров модели**. [Ноутбук](https://github.com/DESimakov/CW/blob/master/CW_Merton_OLS_and_Rolling.ipynb)

### HW1 разные вариации + скользящее окно
Нормальная реализация МП для приращений. Оценка параметров методом наименьших квадратов. Скользящее окно. **Графики параметров модели**. **Добавить dt в vol для HW1_ml_final_diff_cst2** [Ноутбук](https://github.com/DESimakov/CW/blob/master/CW_HW1_OLS+nonparametricmean+p0.ipynb)

### CIR + заготовка для расстояния ecdf
Нормальная реализация МП для приращений. Оценка параметров минимизацией максимального отклониения траекторий от данных. **Заготовка для функции разности ecdf траекторий и данных**. [Ноутбук](https://github.com/DESimakov/CW/blob/master/CW_CIR.ipynb )


## Использование пакета Quant-Lib (искусственный пример)
Калибровка параметров HW1f по цене свапциона. [Ноутбук](https://github.com/DESimakov/CW/blob/master/CW_QuantLib.ipynb)

## В первую очередь:
- [ ] Скользящее окно для CIR.
- [ ] Сделать функцию расстояний.
- [ ] Сравнить модели и сделать выводы.
- [ ] потестить разладки для определения момента переключения. (Вероятнее всего - разладка на начало кризиса, на пик, на выход)
- [ ] HW1 в своей реализации посмотреть на полных данных при фрагментации на отрезки - не кризис, подъем, стагнация. Будет ли нормальный учет  кризисов? Построить траектории на будущее. (*все плохо*)

## Ближайшее:
- [ ] Убрать 2 максимума, 2 минимума, остальное - среднее по моментам времени. Разные распределения.
- [ ] Добавить Jump процессы.
- [ ] dt - учитывает фактическое количество дней между наблюдениями.

## Сделано:
- [x] Посмотреть на <a href="https://www.codecogs.com/eqnedit.php?latex=\theta(t)&space;=&space;const" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\theta(t)&space;=&space;const" title="\theta(t) = const" /></a> . (*аналогичные проблемы*)
- [x] ~~Сделать алгоритм, который подбирает параметры по заданной волатильности (в два шага).~~ (*Для максимального правдоподобия у HW1 вышло, что для в зависимости от начального приближения он каждый раз выбирает одни и те же параметры для разных волатильностей*)
- [x] ~~HW1 численное вычисление интеграла, для подсчета любой функции~~<a href="https://www.codecogs.com/eqnedit.php?latex=\theta(t)&space;=&space;const" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\theta(t)" title="\theta(t)" /></a> (*не надо*)
- [x] Подбор начального приближения. Из мнк? На основе выборочных моментов? (*хорошая идея - выборочные моменты*)
- [x] ~~Случайная выборка параметров в правдоподобии.~~ (*мало данных - совсем плохие значения, либо не сходится*)
- [x] ~~Так как при dt параметры не случайны, оценить их методом наименьших квадратов, а волатильность оценить при помощи максимального правдоподобия. Добавить регуляризацию!~~ (*Особого эффекта нет, все плохо*)

#### TODO List
* Другие способы оптимизации (*разные вариации численных методов не показали хороший результат*). Градиентный спуск максимального правдоподобия? (*не очень хорошо себя показал*)
* Сделать уже функции для отрисовки графиков/путей/скользящиз и запихнуть их в .py . В идеале написать класс.
